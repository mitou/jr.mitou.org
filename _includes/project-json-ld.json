{%- assign pj   = site.data.projects | where_exp: "pj", "pj.id == include.project_id" | first -%}
{%- assign lang = page.lang | default: 'ja' -%}
{%- if page.lang == 'en' -%}
  {% assign pj_title       = pj.title_en       | strip_html | escape   %}
  {% assign pj_description = pj.description_en | strip_html | escape   %}
  {% assign pj_promotion   = pj.promotion_en   | default: pj.promotion %}
{%- else -%}
  {% assign pj_title       = pj.title          | strip_html | escape %}
  {% assign pj_description = pj.description    | strip_html | escape %}
  {% assign pj_promotion   = pj.promotion %}
{%- endif -%}
{%- assign mentor = site.data.mentors | where: "id", pj.mentor_id | first -%}
{
  "@context"   : "https://schema.org",
  "@type"      : "CreativeWork",
  "@id"        : "{{ site.url }}{{ page.url | remove: '.json' }}",
  "name"       : "{{ pj_title }}",
  "description": "{{ pj_description | strip_newlines | replace: '"', '\\"' }}",
  "creator": [
    {%- for creator_id in pj.creator_ids -%}
      {% assign creator = site.data.creators | where: "id", creator_id | first %}
      {
        "@type": "Person",
        {%- if page.lang == 'en' -%}
          "name" : "{{ creator.id | split: '_' | first | capitalize }} {{ creator.id | split: '_' | last  | capitalize }}"
        {%- else -%}
          "name" : "{{ creator.name }}"
        {%- endif -%}
      }{% unless forloop.last %},{% endunless %}
    {%- endfor -%}
  ],
  "contributor": {
    "@type": "Person",
    {%- if page.lang == 'en' -%}
    "name" : "{{ mentor.id | split: '_' | first | capitalize }} {{ mentor.id | split: '_' | last  | capitalize }}",
    {%- else -%}
    "name" : "{{ mentor.name.last }} {{ mentor.name.first }}",
    {%- endif -%}
    "url"  : "https://jr.mitou.org/mentors/{% if mentor.is_alumni %}alumni{% endif %}#{{ pj.mentor_id }}"
  }{%- if pj.final -%},
  "video": {
    "@type"        : "VideoObject",
    "name"         : "{{ pj_title }}",
    "embedUrl"     : "https://www.youtube.com/embed/{{ pj.final }}",
    "description"  : "{{ pj_description | strip_newlines | replace: '"', '\\"' }}",
    "thumbnailUrl" : "{{ page.thumbnail }}",
    "uploadDate"   : "{{ pj.year }}-11-03T10:00:00+09:00"
  }{%- endif -%},
  "dateCreated": "{{ pj.year }}-10-01T10:00:00+09:00",
  "educationalLevel": {%- if page.lang == 'en' -%}"Primary and Secondary Education (Ages 17 and under)"{%- else -%}"小中高生・高専生"{%- endif -%},
  "inLanguage": "{{ lang }}",
  "isPartOf": {
    "@type": "EducationalProgram",
    "name": {%- if page.lang == 'en' -%}"MITOU Junior"{%- else -%}"未踏ジュニア"{%- endif -%},
    "url": "https://jr.mitou.org"
  }
}
